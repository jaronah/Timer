"use strict";const timer={currentAlarm:"",alarms:{iron:new Audio("./dist/audio/alarm_iron.mp3"),air:new Audio("./dist/audio/alarm_air.mp3")},customAlarms:isJsonObject(localStorage.getItem("customAlarms"))?JSON.parse(localStorage.getItem("customAlarms")):{},repeatAlarm:!1,secondsMax:59,minutesMax:59,hoursMax:99,htmlTimerTime:document.getElementById("timerTime"),htmlTimerSeconds:document.getElementById("timerSeconds"),htmlTimerMinutes:document.getElementById("timerMinutes"),htmlTimerHours:document.getElementById("timerHours"),htmlBtnEdit:document.getElementById("btnEdit"),htmlBtnStartOrPause:document.getElementById("btnStartOrPause"),htmlBtnReset:document.getElementById("btnReset"),htmlModalEdit:{container:document.getElementById("modalEditTimer"),closableArea:document.getElementById("closableAreaOfEditTimer"),btnCancel:document.getElementById("btnCancelModalEditTimer"),btnStorno:document.getElementById("btnStornoModalEditTimer"),btnSave:document.getElementById("btnSaveModalEditTimer"),btnSecondIncrement:document.getElementById("seconds-increment"),btnSecondDecrement:document.getElementById("seconds-decrement"),btnMinuteIncrement:document.getElementById("minutes-increment"),btnMinuteDecrement:document.getElementById("minutes-decrement"),btnHourIncrement:document.getElementById("hours-increment"),btnHourDecrement:document.getElementById("hours-decrement"),seconds:document.getElementById("modalSeconds"),minutes:document.getElementById("modalMinutes"),hours:document.getElementById("modalHours"),selectAlarm:document.getElementById("modalSelectAlarm"),btnPlayOrPauseAlarm:document.getElementById("btnPlayOrPauseAlarm"),btnBrowseAlarm:document.getElementById("btnBrowseAlarm"),iconPlayAlarm:document.getElementById("iconPlayAlarm"),iconPauseAlarm:document.getElementById("iconPauseAlarm"),checkboxRepeatAlarm:document.getElementById("checkboxRepeatAlarm"),reset:function(){timer.renderTimeoutForModal(),timer.setCurrentAlarmFromLocalStorage(),timer.setRepeatAlarm()},close:function(){openOrCloseModal(timer.htmlModalEdit.container),pauseAudio(timer.currentAlarm)}},htmlModalMessage:{container:document.getElementById("modalMessage"),closableArea:document.getElementById("closableAreaOfModalMessage"),btnSubmit:document.getElementById("btnSubmitMessage")},setUserSettings:function(){this.renderCustomAlarms(),this.setCurrentAlarmFromLocalStorage(),this.setRepeatAlarm()},setTimeout:function(){localStorage.setItem("timerSeconds",Number(this.htmlModalEdit.seconds.value)),localStorage.setItem("timerMinutes",Number(this.htmlModalEdit.minutes.value)),localStorage.setItem("timerHours",Number(this.htmlModalEdit.hours.value))},setCurrentAlarm:function(){this.currentAlarm=this.alarms[this.htmlModalEdit.selectAlarm.selectedOptions[0].value]},setCurrentAlarmFromLocalStorage:function(){const e=localStorage.getItem("currentAlarmName");if(this.alarms.hasOwnProperty(e))for(let t=0;t<this.htmlModalEdit.selectAlarm.length;t++)if(this.htmlModalEdit.selectAlarm[t].value===e){this.htmlModalEdit.selectAlarm.selectedIndex=t;break}this.setCurrentAlarm()},setRepeatAlarm:function(){this.htmlModalEdit.checkboxRepeatAlarm.checked=JSON.parse(localStorage.getItem("repeatAlarm"))},getTimeout:function(){let e=0,t=0,r=0,i=0;return null!=localStorage.getItem("timerSeconds")&&null!=localStorage.getItem("timerMinutes")&&null!=localStorage.getItem("timerHours")&&(i=(e=Number(localStorage.getItem("timerSeconds")))+60*(t=Number(localStorage.getItem("timerMinutes")))+60*(r=Number(localStorage.getItem("timerHours")))*60),i},getCurrentTime:function(){let e=0,t=0,r=0,i=0;return i=(e=Number(this.htmlTimerSeconds.innerText))+60*(t=Number(this.htmlTimerMinutes.innerText))+60*(r=Number(this.htmlTimerHours.innerText))*60},getStatusOfTimeout:function(){let e={isSet:!1};return null!=localStorage.getItem("timerSeconds")&&null!=localStorage.getItem("timerMinutes")&&null!=localStorage.getItem("timerHours")&&(e.isSet=!0),e},renderTimeout:function(){let e;return e=this.renderTimeoutForTimer(),this.renderTimeoutForModal(),0===this.getCurrentTime()?this.htmlTimerTime.classList.add("disabled"):this.htmlTimerTime.classList.remove("disabled"),e},renderTimeoutForTimer:function(){let e={isSet:!1};return null!=localStorage.getItem("timerSeconds")&&null!=localStorage.getItem("timerMinutes")&&null!=localStorage.getItem("timerHours")&&(this.htmlTimerSeconds.innerText=getLeadingZerosNumber(localStorage.getItem("timerSeconds")),this.htmlTimerMinutes.innerText=getLeadingZerosNumber(localStorage.getItem("timerMinutes")),this.htmlTimerHours.innerText=getLeadingZerosNumber(localStorage.getItem("timerHours")),e.isSet=!0),e},renderTimeoutForModal:function(){let e={isSet:!1};return null!=localStorage.getItem("timerSeconds")&&null!=localStorage.getItem("timerMinutes")&&null!=localStorage.getItem("timerHours")&&(this.htmlModalEdit.seconds.value=getLeadingZerosNumber(localStorage.getItem("timerSeconds")),this.htmlModalEdit.minutes.value=getLeadingZerosNumber(localStorage.getItem("timerMinutes")),this.htmlModalEdit.hours.value=getLeadingZerosNumber(localStorage.getItem("timerHours")),e.isSet=!0),e},renderCustomAlarms:function(){if(Object.keys(this.customAlarms).length>0)for(let e in this.customAlarms)if(!this.htmlModalEdit.selectAlarm.contains(e)){const t=document.createElement("option");t.innerText=e,this.htmlModalEdit.selectAlarm.appendChild(t),this.alarms[e]=new Audio(this.customAlarms[e])}},countdown:function(e){let t=Number(this.htmlTimerSeconds.innerText)+60*Number(this.htmlTimerMinutes.innerText)+60*Number(this.htmlTimerHours.innerText)*60,r=setInterval(()=>{!this.htmlBtnStartOrPause.classList.contains("isPaused")&&t>0&&(t--,this.htmlTimerSeconds.innerText=getLeadingZerosNumber(t%60),this.htmlTimerMinutes.innerText=getLeadingZerosNumber(Math.floor(t/60%60)),this.htmlTimerHours.innerText=getLeadingZerosNumber(Math.floor(t/60/60))),0===t&&(this.currentAlarm instanceof Audio&&this.currentAlarm.play(),this.currentAlarm instanceof Audio&&this.htmlModalEdit.checkboxRepeatAlarm.checked&&(this.repeatAlarm=setInterval(()=>{this.currentAlarm.play()},1e3*this.currentAlarm.duration+800)),this.htmlBtnStartOrPause.classList.add("isPaused"),this.htmlBtnStartOrPause.innerText="START",this.htmlBtnStartOrPause.disabled=!0,this.htmlBtnReset.disabled=!1,this.htmlBtnEdit.disabled=!1,this.htmlTimerTime.classList.add("disabled"),openOrCloseModal(this.htmlModalMessage.container)),this.htmlBtnStartOrPause.classList.contains("isPaused")&&(e.preventDefault(),clearInterval(r))},1e3)},enableOrDisableControlButtons:function(){let e=this.getStatusOfTimeout(),t=this.getCurrentTime(),r=this.getTimeout();0===t?(this.htmlBtnStartOrPause.classList.add("isPaused"),this.htmlBtnStartOrPause.innerText="START",this.htmlBtnStartOrPause.disabled=!0,this.htmlBtnEdit.disabled=!1,this.htmlBtnReset.disabled=!e.isSet):t>0&&t<r?(this.htmlBtnStartOrPause.disabled=!1,this.htmlBtnEdit.disabled=!1,this.htmlBtnReset.disabled=!1):t===r&&(this.htmlBtnStartOrPause.disabled=!1,this.htmlBtnEdit.disabled=!1,this.htmlBtnReset.disabled=!0)},startOrPause:function(e){timer.htmlBtnStartOrPause.classList.contains("isPaused")?(timer.htmlBtnStartOrPause.innerText="PAUSE",timer.htmlBtnEdit.disabled=!0,timer.htmlBtnReset.disabled=!0,timer.currentAlarm instanceof Audio&&timer.currentAlarm.currentTime>0&&timer.currentAlarm.load()):(timer.htmlBtnStartOrPause.innerText="START",timer.htmlBtnEdit.disabled=!1,timer.getCurrentTime()!=timer.getTimeout()&&(timer.htmlBtnReset.disabled=!1)),timer.htmlBtnStartOrPause.classList.toggle("isPaused"),timer.countdown(e)},playOrPauseAlarmPreview:function(){timer.currentAlarm instanceof Audio&&("isPlaying"===timer.htmlModalEdit.btnPlayOrPauseAlarm.getAttribute("status")?timer.currentAlarm.pause():timer.currentAlarm.play(),timer.currentAlarm.onpause=(()=>{switchIconPauseToPlay(timer.htmlModalEdit.btnPlayOrPauseAlarm,timer.htmlModalEdit.iconPlayAlarm,timer.htmlModalEdit.iconPauseAlarm)}),timer.currentAlarm.onplay=(()=>{switchIconPlayToPause(timer.htmlModalEdit.btnPlayOrPauseAlarm,timer.htmlModalEdit.iconPlayAlarm,timer.htmlModalEdit.iconPauseAlarm)}))},reset:function(){timer.renderTimeout(),timer.htmlBtnStartOrPause.disabled=!1,timer.getCurrentTime()===timer.getTimeout()&&(timer.htmlBtnReset.disabled=!0)},openModalEdit:function(){openOrCloseModal(timer.htmlModalEdit.container),timer.currentAlarm instanceof Audio&&timer.currentAlarm.load()},closeAndDiscardModalEdit:function(){timer.htmlModalEdit.reset(),timer.htmlModalEdit.close()},closeAndSaveModalEdit:function(){let e=0;(e=Number(timer.htmlModalEdit.seconds.value)+60*Number(timer.htmlModalEdit.minutes.value)+60*Number(timer.htmlModalEdit.hours.value)*60)>0?(timer.setTimeout(),timer.renderTimeout(),localStorage.setItem("currentAlarmName",timer.htmlModalEdit.selectAlarm.selectedOptions[0].value),localStorage.setItem("repeatAlarm",timer.htmlModalEdit.checkboxRepeatAlarm.checked),openOrCloseModal(timer.htmlModalEdit.container)):(timer.renderTimeoutForModal(),alert("Timeout could not be set. Only time more than 0.")),pauseAudio(timer.currentAlarm),timer.enableOrDisableControlButtons()},closeModalMessage:function(){openOrCloseModal(timer.htmlModalMessage.container),timer.repeatAlarm&&clearInterval(timer.repeatAlarm),pauseAudio(timer.currentAlarm)},handleSelectedAlarm:function(){pauseAudio(timer.currentAlarm),timer.setCurrentAlarm(),timer.currentAlarm instanceof Audio&&timer.currentAlarm.load()},importCustomAlarm:function(){const e=new FileReader,t=timer.htmlModalEdit.btnBrowseAlarm.files[0];t&&e.readAsDataURL(t),e.addEventListener("loadend",function(e){t.size<=5242880&&t.type.includes("audio")?(timer.customAlarms[clearFileSuffix(t.name)]=e.target.result,localStorage.setItem("customAlarms",JSON.stringify(timer.customAlarms)),timer.renderCustomAlarms()):t.type.includes("audio")?t.size>5242880&&alert("Chosen audio is over 5MB. Choose smaller, please."):alert("Chosen file is not of type audio. Choose another file, please.")})},incrementTimeUnit:function(e,t){e.value<t&&(e.value++,leadingZeros(e))},decrementTimeUnit:function(e){e.value>0&&(e.value--,leadingZeros(e))},incrementSeconds:function(){timer.incrementTimeUnit(timer.htmlModalEdit.seconds,timer.secondsMax)},incrementMinutes:function(){timer.incrementTimeUnit(timer.htmlModalEdit.minutes,timer.minutesMax)},incrementHours:function(){timer.incrementTimeUnit(timer.htmlModalEdit.hours,timer.hoursMax)},decrementSeconds:function(){timer.decrementTimeUnit(timer.htmlModalEdit.seconds)},decrementMinutes:function(){timer.decrementTimeUnit(timer.htmlModalEdit.minutes)},decrementHours:function(){timer.decrementTimeUnit(timer.htmlModalEdit.hours)},controlTimeUnit:function(e,t){e.value>t&&(e.value=t)},controlSeconds:function(){timer.controlTimeUnit(timer.htmlModalEdit.seconds,timer.secondsMax)},controlMinutes:function(){timer.controlTimeUnit(timer.htmlModalEdit.minutes,timer.minutesMax)},controlHours:function(){timer.controlTimeUnit(timer.htmlModalEdit.hours,timer.hoursMax)}};